<form>
  <label>Cognito Detect Overview</label>
  <fieldset submitButton="false">
    <input type="time" token="timepicker" searchWhenChanged="true">
      <label>Timerange:</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <single>
        <title>High</title>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:hostscoring" threat&gt;=50 certainty&lt;50 | timechart dc(src) as count</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x65a637","0xf05a28"]</option>
        <option name="rangeValues">[-1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">0</option>
        <option name="showTrendIndicator">1</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-1h</option>
        <option name="underLabel">Compared to 1 hour before</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
        <drilldown>
          <link>hosts?form.hostseverity=threat%3E%3D50%20certainty%3C%3D50</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Critical</title>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:hostscoring" threat&gt;=50 certainty&gt;=50 | timechart dc(src) as count</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x65a637","0xbe1e2d"]</option>
        <option name="rangeValues">[-1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">0</option>
        <option name="showTrendIndicator">1</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">auto</option>
        <option name="underLabel">Compared to 24 hours before</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
        <drilldown>
          <link>hosts?form.hostseverity=threat%3E%3D50%20certainty%3E%3D50</link>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>Low</title>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:hostscoring" threat&gt;0 threat&lt;50 certainty&gt;0 certainty&lt;50 | timechart dc(src) as count</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x65a637","0x4e6875"]</option>
        <option name="rangeValues">[-1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">0</option>
        <option name="showTrendIndicator">1</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">-24h</option>
        <option name="underLabel">Compared to 24 hours before</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
        <drilldown>
          <link>hosts?form.hostseverity=threat%3E0%20AND%20threat%3C50%20certainty%3E0%20AND%20certainty%3C50</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Medium</title>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:hostscoring" threat&lt;50 certainty&gt;=50 | timechart dc(src) as count</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x65a637","0xfaaf40"]</option>
        <option name="rangeValues">[-1]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">0</option>
        <option name="showTrendIndicator">1</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="trendInterval">auto</option>
        <option name="underLabel">Compared to 24 hours before</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
        <drilldown>
          <link>hosts?form.hostseverity=threat%3C%3D50%20certainty%3E%3D50</link>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <html>
      <p/>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Worst Offenders</title>
      <table>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:hostscoring"  | dedup src | table src,src_ip,threat,certainty,_time | sort -num(threat), -num(certainty) | head 10 | convert timeformat="%Y-%m-%dT%H:%M:%S%z" ctime(_time) |rename src as "Source", src_ip as "Source IP", threat as "Threat", certainty as "Certainty", _time as "Latest Detection"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
        <format type="number" field="Latest Detection"></format>
        <drilldown>
          <link>
            <![CDATA[detections?form.search=$click.value$&form.time.earliest=$field1.earliest$&form.time.latest=$field1.latest$]]>
          </link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Key Assets</title>
      <table>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:hostscoring"  src_key_asset="True" OR dest_key_asset="True" | dedup src | table src,src_ip,src_key_asset,dest_key_asset,threat,certainty,_time | sort -num(threat), -num(certainty) | head 10 | convert timeformat="%Y-%m-%dT%H:%M:%S%z" ctime(_time) |rename src as "Source", src_ip as "Source IP", src_key_asset AS "Src Key Asset", dest_key_asset AS "Dest Key Asset", threat as "Threat", certainty as "Certainty", _time as "Latest Detection"</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <link>
            <![CDATA[detections?form.search=$click.value$&form.time.earliest=$field1.earliest$&form.time.latest=$field1.latest$]]>
          </link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Detections By Type</title>
      <chart>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:*" signature!="hsc" signature!="audit" signature!="campaigns" signature!="health" | stats count by signature_name</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisLabelsY.majorUnit">1</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.text">Amount of Detections</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">bar</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">none</option>
        <option name="height">500</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link>detections?form.name=$click.value$</link>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <title>Detections By Category</title>
      <chart>
        <search>
          <query>`vectra_index` sourcetype="vectra:cognito:*" signature!="hsc" signature!="audit" signature!="campaigns" signature!="health" | stats count by category</query>
          <earliest>$timepicker.earliest$</earliest>
          <latest>$timepicker.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisLabelsY.majorUnit">1</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">bar</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">none</option>
        <option name="height">500</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link>detections?form.cat=$click.value$</link>
        </drilldown>
      </chart>
    </panel>
  </row>
</form>